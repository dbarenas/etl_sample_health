[0m07:12:16.695967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9a50e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c99385b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c99385b70>]}


============================== 07:12:16.704855 | ee796d78-439f-4cc6-b9ae-d2067aea7e12 ==============================
[0m07:12:16.704855 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:12:16.705581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m07:12:16.712984 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m07:12:16.713791 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "patient_etl_profile", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m07:12:16.720901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.10905453, "process_in_blocks": "14280", "process_kernel_time": 0.915739, "process_mem_max_rss": "97500", "process_out_blocks": "16", "process_user_time": 2.193076}
[0m07:12:16.721560 [debug] [MainThread]: Command `dbt run` failed at 07:12:16.721417 after 0.11 seconds
[0m07:12:16.722163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9a50e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c99387fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c99385ff0>]}
[0m07:12:16.722683 [debug] [MainThread]: Flushing usage events
[0m07:12:16.843711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:12:28.865860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655347e6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65523b4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65523b4e80>]}


============================== 07:12:28.869867 | c478ac74-d0bb-4920-9450-ee91abc1ec30 ==============================
[0m07:12:28.869867 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:12:28.870618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:12:29.124964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c478ac74-d0bb-4920-9450-ee91abc1ec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6554beb7c0>]}
[0m07:12:29.215743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c478ac74-d0bb-4920-9450-ee91abc1ec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6553128b20>]}
[0m07:12:29.216922 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:12:29.374642 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:12:29.375780 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:12:29.376322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c478ac74-d0bb-4920-9450-ee91abc1ec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6552a041c0>]}
[0m07:12:31.370524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c478ac74-d0bb-4920-9450-ee91abc1ec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65510d9000>]}
[0m07:12:31.531545 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:12:31.534971 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:12:31.562315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c478ac74-d0bb-4920-9450-ee91abc1ec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65510da410>]}
[0m07:12:31.563144 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:12:31.563705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c478ac74-d0bb-4920-9450-ee91abc1ec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65510d9ba0>]}
[0m07:12:31.566336 [info ] [MainThread]: 
[0m07:12:31.566841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:12:31.567293 [info ] [MainThread]: 
[0m07:12:31.568135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:12:31.575756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:12:31.671289 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:12:31.671937 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:12:31.672415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:12:31.675516 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m07:12:31.678315 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:12:31.678866 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:12:31.679471 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:12:31.679879 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:12:31.680339 [debug] [ThreadPool]: On list_etl_data: No close available on handle
[0m07:12:31.681793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:12:31.682289 [debug] [MainThread]: Connection 'list_etl_data' was properly closed.
[0m07:12:31.682713 [info ] [MainThread]: 
[0m07:12:31.683381 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m07:12:31.684044 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m07:12:31.685782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9028451, "process_in_blocks": "896", "process_kernel_time": 0.612253, "process_mem_max_rss": "120416", "process_out_blocks": "1776", "process_user_time": 4.566278}
[0m07:12:31.686420 [debug] [MainThread]: Command `dbt run` failed at 07:12:31.686269 after 2.90 seconds
[0m07:12:31.686906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655347e6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65510d8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6550f83190>]}
[0m07:12:31.687589 [debug] [MainThread]: Flushing usage events
[0m07:12:31.806460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:13:07.274523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddb2465f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dda23bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dda239ba0>]}


============================== 07:13:07.278501 | 36d5b565-1fd6-4737-8b77-e2082d68ec0f ==============================
[0m07:13:07.278501 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:13:07.279161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:13:07.519619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36d5b565-1fd6-4737-8b77-e2082d68ec0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddc9aece0>]}
[0m07:13:07.611161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36d5b565-1fd6-4737-8b77-e2082d68ec0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dda827af0>]}
[0m07:13:07.612408 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:13:07.735316 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:13:07.910004 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:13:07.910763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36d5b565-1fd6-4737-8b77-e2082d68ec0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dda7c87c0>]}
[0m07:13:09.714629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36d5b565-1fd6-4737-8b77-e2082d68ec0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dd8ee5990>]}
[0m07:13:09.866315 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:13:09.869946 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:13:09.887646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36d5b565-1fd6-4737-8b77-e2082d68ec0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dd8ec3250>]}
[0m07:13:09.888618 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:13:09.889198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36d5b565-1fd6-4737-8b77-e2082d68ec0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dd8ec3220>]}
[0m07:13:09.892272 [info ] [MainThread]: 
[0m07:13:09.892839 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:13:09.893462 [info ] [MainThread]: 
[0m07:13:09.894300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:13:09.902090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:13:09.952936 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:13:09.953619 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:13:09.954133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:13:09.955629 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:13:09.956682 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:13:09.957108 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:13:09.957634 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:13:09.958116 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:13:09.958577 [debug] [ThreadPool]: On list_etl_data: No close available on handle
[0m07:13:09.959821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:13:09.960271 [debug] [MainThread]: Connection 'list_etl_data' was properly closed.
[0m07:13:09.960744 [info ] [MainThread]: 
[0m07:13:09.961198 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m07:13:09.962014 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:13:09.963308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.771224, "process_in_blocks": "458", "process_kernel_time": 0.298728, "process_mem_max_rss": "120056", "process_out_blocks": "1768", "process_user_time": 4.660378}
[0m07:13:09.963927 [debug] [MainThread]: Command `dbt run` failed at 07:13:09.963787 after 2.77 seconds
[0m07:13:09.964459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddb2465f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dd8ec21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dd8d59450>]}
[0m07:13:09.964989 [debug] [MainThread]: Flushing usage events
[0m07:13:10.087861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:13:34.170721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f96c66e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f8584e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f8584e80>]}


============================== 07:13:34.174753 | f7289186-16ad-4058-b176-c3c1674701e9 ==============================
[0m07:13:34.174753 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:13:34.175444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:13:34.415167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7289186-16ad-4058-b176-c3c1674701e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05fb6c34f0>]}
[0m07:13:34.505595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7289186-16ad-4058-b176-c3c1674701e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f936cb20>]}
[0m07:13:34.506821 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:13:34.618987 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:13:34.812044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:13:34.812691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:13:34.892036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7289186-16ad-4058-b176-c3c1674701e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f79e52a0>]}
[0m07:13:35.042553 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:13:35.045971 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:13:35.062003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7289186-16ad-4058-b176-c3c1674701e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f79e45b0>]}
[0m07:13:35.062820 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:13:35.063344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7289186-16ad-4058-b176-c3c1674701e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f7f080d0>]}
[0m07:13:35.065770 [info ] [MainThread]: 
[0m07:13:35.066263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:13:35.066706 [info ] [MainThread]: 
[0m07:13:35.067364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:13:35.074148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:13:35.126934 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:13:35.127626 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:13:35.128081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:13:35.129501 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:13:35.130670 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:13:35.131113 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:13:35.131647 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:13:35.132051 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:13:35.132498 [debug] [ThreadPool]: On list_etl_data: No close available on handle
[0m07:13:35.133848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:13:35.134290 [debug] [MainThread]: Connection 'list_etl_data' was properly closed.
[0m07:13:35.134764 [info ] [MainThread]: 
[0m07:13:35.135193 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m07:13:35.135877 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:13:35.137093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0483981, "process_in_blocks": "458", "process_kernel_time": 0.220825, "process_mem_max_rss": "113024", "process_out_blocks": "928", "process_user_time": 3.030863}
[0m07:13:35.137790 [debug] [MainThread]: Command `dbt run` failed at 07:13:35.137574 after 1.05 seconds
[0m07:13:35.138336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f96c66e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f79e6d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f752f1c0>]}
[0m07:13:35.138925 [debug] [MainThread]: Flushing usage events
[0m07:13:35.324748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:14:27.974913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3136a46f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313595fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313595f9a0>]}


============================== 07:14:27.979312 | 8413d26d-aaa0-4b49-876a-d370b290a150 ==============================
[0m07:14:27.979312 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:14:27.980066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:14:28.238431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8413d26d-aaa0-4b49-876a-d370b290a150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3138311390>]}
[0m07:14:28.333959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8413d26d-aaa0-4b49-876a-d370b290a150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3137ffbc70>]}
[0m07:14:28.335202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:14:28.451075 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:14:28.659906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:28.660518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:28.749820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8413d26d-aaa0-4b49-876a-d370b290a150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31349edae0>]}
[0m07:14:28.919423 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:14:28.923117 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:14:28.941319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8413d26d-aaa0-4b49-876a-d370b290a150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3134976fe0>]}
[0m07:14:28.942322 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:14:28.942938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8413d26d-aaa0-4b49-876a-d370b290a150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3134975960>]}
[0m07:14:28.945518 [info ] [MainThread]: 
[0m07:14:28.946134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:14:28.946514 [info ] [MainThread]: 
[0m07:14:28.947281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:14:28.954515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:14:29.012123 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:14:29.012861 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:14:29.013314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:29.014740 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:14:29.015790 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:14:29.016225 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:14:29.016779 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:14:29.017190 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:14:29.017596 [debug] [ThreadPool]: On list_etl_data: No close available on handle
[0m07:14:29.019330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:29.019937 [debug] [MainThread]: Connection 'list_etl_data' was properly closed.
[0m07:14:29.020406 [info ] [MainThread]: 
[0m07:14:29.021064 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m07:14:29.022147 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:14:29.023546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1364057, "process_in_blocks": "448", "process_kernel_time": 0.227159, "process_mem_max_rss": "113460", "process_out_blocks": "920", "process_user_time": 4.052173}
[0m07:14:29.024307 [debug] [MainThread]: Command `dbt run` failed at 07:14:29.024156 after 1.14 seconds
[0m07:14:29.025007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3136a46f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31349756c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31348362c0>]}
[0m07:14:29.025819 [debug] [MainThread]: Flushing usage events
[0m07:14:29.227607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:15:14.698938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1e21aec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1d0779a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1d077940>]}


============================== 07:15:14.703070 | 6ced1add-93a9-4ce4-83da-8ddbc6942e83 ==============================
[0m07:15:14.703070 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:15:14.703774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m07:15:14.949608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ced1add-93a9-4ce4-83da-8ddbc6942e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1fabd360>]}
[0m07:15:15.039189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ced1add-93a9-4ce4-83da-8ddbc6942e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1d077a90>]}
[0m07:15:15.040371 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:15:15.152025 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:15:15.347189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:15:15.347834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:15:15.431988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ced1add-93a9-4ce4-83da-8ddbc6942e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1c005a80>]}
[0m07:15:15.589916 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:15:15.593205 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:15:15.609254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ced1add-93a9-4ce4-83da-8ddbc6942e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1c004bb0>]}
[0m07:15:15.610170 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:15:15.610688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ced1add-93a9-4ce4-83da-8ddbc6942e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1d27ac80>]}
[0m07:15:15.613161 [info ] [MainThread]: 
[0m07:15:15.613654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:15:15.614153 [info ] [MainThread]: 
[0m07:15:15.614851 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:15:15.622242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:15:15.676350 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:15:15.677028 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:15:15.677454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:15.678808 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:15:15.679803 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:15:15.680241 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:15:15.680686 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:15:15.681140 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:15:15.681526 [debug] [ThreadPool]: On list_etl_data: No close available on handle
[0m07:15:15.682986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:15:15.683497 [debug] [MainThread]: Connection 'list_etl_data' was properly closed.
[0m07:15:15.683979 [info ] [MainThread]: 
[0m07:15:15.684440 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m07:15:15.685134 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:15:15.686477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0732086, "process_in_blocks": "450", "process_kernel_time": 0.255004, "process_mem_max_rss": "113080", "process_out_blocks": "920", "process_user_time": 3.131604}
[0m07:15:15.687130 [debug] [MainThread]: Command `dbt run` failed at 07:15:15.686972 after 1.07 seconds
[0m07:15:15.687614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1e21aec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1c006d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1c04e8f0>]}
[0m07:15:15.688190 [debug] [MainThread]: Flushing usage events
[0m07:15:15.893126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:16:36.799926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0dfa6ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0ce779a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0ce77940>]}


============================== 07:16:36.805002 | a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b ==============================
[0m07:16:36.805002 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:16:36.805777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:16:37.080010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0f849360>]}
[0m07:16:37.176709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0ce77a90>]}
[0m07:16:37.177992 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:16:37.316238 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:16:37.542854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:16:37.543515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:16:37.626348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0c101a80>]}
[0m07:16:37.786743 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:16:37.790488 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:16:37.806842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0c100bb0>]}
[0m07:16:37.807603 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:16:37.808145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0d07b910>]}
[0m07:16:37.811468 [info ] [MainThread]: 
[0m07:16:37.812011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:16:37.812400 [info ] [MainThread]: 
[0m07:16:37.813212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:16:37.821043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:16:37.952998 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:16:37.953814 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:16:37.954327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:38.034592 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.080 seconds
[0m07:16:38.037301 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:16:38.040080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:16:38.151011 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:16:38.151747 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:16:38.152272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:38.167053 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m07:16:38.167640 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:16:38.168182 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:16:38.178082 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m07:16:38.179975 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:16:38.181054 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:16:38.188084 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.188744 [debug] [MainThread]: On master: BEGIN
[0m07:16:38.189189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:16:38.203056 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:16:38.203715 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.204339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:16:38.213211 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m07:16:38.215089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0c22f8e0>]}
[0m07:16:38.215779 [debug] [MainThread]: On master: ROLLBACK
[0m07:16:38.216948 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.217394 [debug] [MainThread]: On master: BEGIN
[0m07:16:38.219026 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:16:38.219477 [debug] [MainThread]: On master: COMMIT
[0m07:16:38.219973 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.220380 [debug] [MainThread]: On master: COMMIT
[0m07:16:38.221303 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:16:38.221914 [debug] [MainThread]: On master: Close
[0m07:16:38.233779 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:16:38.234658 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:16:38.235418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:16:38.235969 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:16:38.247840 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:16:38.248830 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:16:38.297414 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:16:38.298839 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:16:38.299415 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:16:38.299914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:38.313459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:16:38.314149 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:16:38.314677 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:16:38.316228 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:16:38.316790 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:16:38.318033 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:16:38.329093 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:16:38.331706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0d0f0520>]}
[0m07:16:38.332714 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.09s]
[0m07:16:38.333556 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:16:38.334274 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:16:38.335013 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:16:38.335767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:16:38.336347 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:16:38.341008 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:16:38.341957 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_device_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql.
[0m07:16:38.343732 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:16:38.350794 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:16:38.351613 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:16:38.352146 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:16:38.352578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:38.366449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:16:38.367105 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:16:38.367645 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:16:38.369111 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:16:38.369616 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:16:38.370968 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:16:38.372615 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:16:38.373380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c90dac-5c3c-4cc0-b4d5-d79115e7f08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0e03fac0>]}
[0m07:16:38.374383 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.04s]
[0m07:16:38.375382 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:16:38.376234 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql.
[0m07:16:38.377335 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:16:38.378134 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:16:38.378965 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:16:38.381327 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.381927 [debug] [MainThread]: On master: BEGIN
[0m07:16:38.382334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:16:38.396831 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:16:38.397419 [debug] [MainThread]: On master: COMMIT
[0m07:16:38.397999 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.398401 [debug] [MainThread]: On master: COMMIT
[0m07:16:38.399337 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:16:38.399783 [debug] [MainThread]: On master: Close
[0m07:16:38.400466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:16:38.400857 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:16:38.401407 [info ] [MainThread]: 
[0m07:16:38.401989 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m07:16:38.403184 [debug] [MainThread]: Command end result
[0m07:16:38.436435 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:16:38.439017 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:16:38.448348 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:16:38.448831 [info ] [MainThread]: 
[0m07:16:38.449387 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:16:38.449931 [info ] [MainThread]: 
[0m07:16:38.450528 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:16:38.450995 [info ] [MainThread]: 
[0m07:16:38.451469 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:16:38.451918 [info ] [MainThread]: 
[0m07:16:38.452357 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:16:38.453528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7449251, "process_in_blocks": "614", "process_kernel_time": 0.621115, "process_mem_max_rss": "117184", "process_out_blocks": "1872", "process_user_time": 3.374318}
[0m07:16:38.454251 [debug] [MainThread]: Command `dbt run` failed at 07:16:38.454104 after 1.75 seconds
[0m07:16:38.454755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0dfa6ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0efc0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0dc2d720>]}
[0m07:16:38.455325 [debug] [MainThread]: Flushing usage events
[0m07:16:38.601478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:16:55.815971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9908eaee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9907d846a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9907d84700>]}


============================== 07:16:55.821401 | 033d4e3b-7760-4a30-842a-0d094bd98f40 ==============================
[0m07:16:55.821401 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:16:55.822299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --profiles-dir .', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:16:56.101201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '033d4e3b-7760-4a30-842a-0d094bd98f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9907fcf610>]}
[0m07:16:56.201555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '033d4e3b-7760-4a30-842a-0d094bd98f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99077fc190>]}
[0m07:16:56.202824 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:16:56.338817 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:16:56.564602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:16:56.565257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:16:56.648839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '033d4e3b-7760-4a30-842a-0d094bd98f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99071e5a50>]}
[0m07:16:56.813359 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:16:56.817187 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:16:56.834652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '033d4e3b-7760-4a30-842a-0d094bd98f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99071f6140>]}
[0m07:16:56.835560 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:16:56.836108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '033d4e3b-7760-4a30-842a-0d094bd98f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9909812e60>]}
[0m07:16:56.838977 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:16:56.841892 [debug] [MainThread]: Command end result
[0m07:16:56.879781 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:16:56.882092 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:16:56.887096 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:16:56.887531 [info ] [MainThread]: 
[0m07:16:56.888105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:16:56.888498 [info ] [MainThread]: 
[0m07:16:56.888952 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m07:16:56.890155 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.16673, "process_in_blocks": "458", "process_kernel_time": 0.440187, "process_mem_max_rss": "108216", "process_out_blocks": "1792", "process_user_time": 3.088642}
[0m07:16:56.890758 [debug] [MainThread]: Command `dbt seed` succeeded at 07:16:56.890610 after 1.17 seconds
[0m07:16:56.891298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9908eaee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9907fcf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9908b32560>]}
[0m07:16:56.891799 [debug] [MainThread]: Flushing usage events
[0m07:16:57.009381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:17:00.132120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09459aef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094487fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094487fa00>]}


============================== 07:17:00.137538 | dcb2a1b0-6b8e-456d-adbf-f78c8bd02224 ==============================
[0m07:17:00.137538 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:17:00.138324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:17:00.414321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb2a1b0-6b8e-456d-adbf-f78c8bd02224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094431f8e0>]}
[0m07:17:00.515229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcb2a1b0-6b8e-456d-adbf-f78c8bd02224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0944aebb50>]}
[0m07:17:00.516430 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:17:00.638041 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:17:00.832466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:00.833206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:00.914388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb2a1b0-6b8e-456d-adbf-f78c8bd02224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0943b01b10>]}
[0m07:17:01.066961 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:17:01.070391 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:17:01.086379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb2a1b0-6b8e-456d-adbf-f78c8bd02224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0943b01930>]}
[0m07:17:01.087213 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:17:01.087700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb2a1b0-6b8e-456d-adbf-f78c8bd02224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0943b018d0>]}
[0m07:17:01.090329 [info ] [MainThread]: 
[0m07:17:01.090856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:17:01.091315 [info ] [MainThread]: 
[0m07:17:01.092020 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:17:01.098738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:17:01.151134 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:17:01.151747 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:17:01.152245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:01.170427 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m07:17:01.172450 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:17:01.175031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:17:01.257557 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:17:01.258264 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:17:01.258679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:17:01.273255 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m07:17:01.274009 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:17:01.274496 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:17:01.284014 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m07:17:01.286088 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:17:01.287184 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:17:01.294218 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:01.294882 [debug] [MainThread]: On master: BEGIN
[0m07:17:01.295327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:17:01.309154 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:17:01.309781 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:01.310382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:17:01.319218 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m07:17:01.321082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb2a1b0-6b8e-456d-adbf-f78c8bd02224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0943b4e5c0>]}
[0m07:17:01.321847 [debug] [MainThread]: On master: ROLLBACK
[0m07:17:01.323232 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:01.323710 [debug] [MainThread]: On master: BEGIN
[0m07:17:01.325757 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:17:01.326374 [debug] [MainThread]: On master: COMMIT
[0m07:17:01.326795 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:01.327286 [debug] [MainThread]: On master: COMMIT
[0m07:17:01.328483 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:17:01.329025 [debug] [MainThread]: On master: Close
[0m07:17:01.334105 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:17:01.334943 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:17:01.335628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:17:01.336177 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:17:01.348336 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:17:01.349324 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:17:01.402681 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:17:01.403967 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:17:01.404540 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:17:01.405048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:01.420946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m07:17:01.421806 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:17:01.422501 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:17:01.424409 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:17:01.425174 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:17:01.426797 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:17:01.429981 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:17:01.432806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb2a1b0-6b8e-456d-adbf-f78c8bd02224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0944349180>]}
[0m07:17:01.433979 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.10s]
[0m07:17:01.434859 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:17:01.435532 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:17:01.436453 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_device_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql.
[0m07:17:01.437304 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:17:01.439371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:17:01.439960 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:17:01.444894 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:17:01.446065 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:17:01.453450 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:17:01.454735 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:17:01.455302 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:17:01.455766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:01.471215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m07:17:01.472004 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:17:01.472612 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:17:01.474291 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:17:01.475069 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:17:01.476348 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:17:01.478004 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:17:01.478775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb2a1b0-6b8e-456d-adbf-f78c8bd02224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0945a52530>]}
[0m07:17:01.479771 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.04s]
[0m07:17:01.480634 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:17:01.481542 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql.
[0m07:17:01.483394 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:17:01.484097 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:17:01.484731 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:17:01.487362 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:01.488047 [debug] [MainThread]: On master: BEGIN
[0m07:17:01.488448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:17:01.504120 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:17:01.504820 [debug] [MainThread]: On master: COMMIT
[0m07:17:01.505403 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:01.506045 [debug] [MainThread]: On master: COMMIT
[0m07:17:01.507254 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:17:01.507722 [debug] [MainThread]: On master: Close
[0m07:17:01.508452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:01.508849 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:17:01.509428 [info ] [MainThread]: 
[0m07:17:01.509998 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m07:17:01.511209 [debug] [MainThread]: Command end result
[0m07:17:01.545609 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:17:01.548378 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:17:01.559338 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:17:01.559865 [info ] [MainThread]: 
[0m07:17:01.560445 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:17:01.560859 [info ] [MainThread]: 
[0m07:17:01.561444 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:17:01.562052 [info ] [MainThread]: 
[0m07:17:01.562560 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:17:01.563025 [info ] [MainThread]: 
[0m07:17:01.563480 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:17:01.564746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5255809, "process_in_blocks": "406", "process_kernel_time": 0.7564, "process_mem_max_rss": "117180", "process_out_blocks": "1864", "process_user_time": 3.381637}
[0m07:17:01.565392 [debug] [MainThread]: Command `dbt run` failed at 07:17:01.565238 after 1.53 seconds
[0m07:17:01.566048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09459aef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0943c9bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0943b4e7a0>]}
[0m07:17:01.566603 [debug] [MainThread]: Flushing usage events
[0m07:17:01.684858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:17:48.522200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83145e6f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8313453a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8313453a30>]}


============================== 07:17:48.527201 | 2113eff2-287b-4334-98c4-c53c17130b92 ==============================
[0m07:17:48.527201 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:17:48.527897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m07:17:48.803715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2113eff2-287b-4334-98c4-c53c17130b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312b20100>]}
[0m07:17:48.898878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2113eff2-287b-4334-98c4-c53c17130b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8313be3f40>]}
[0m07:17:48.900154 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:17:49.026763 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:17:49.248823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:49.249484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:49.332170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2113eff2-287b-4334-98c4-c53c17130b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312405b40>]}
[0m07:17:49.492671 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:17:49.496735 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:17:49.514863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2113eff2-287b-4334-98c4-c53c17130b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312407040>]}
[0m07:17:49.515728 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:17:49.516266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2113eff2-287b-4334-98c4-c53c17130b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312406fe0>]}
[0m07:17:49.519203 [info ] [MainThread]: 
[0m07:17:49.519707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:17:49.520139 [info ] [MainThread]: 
[0m07:17:49.520919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:17:49.528378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:17:49.636034 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:17:49.636719 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:17:49.637202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:49.673409 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.036 seconds
[0m07:17:49.675880 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:17:49.678303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:17:49.762163 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:17:49.762763 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:17:49.763246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:17:49.779095 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m07:17:49.779672 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:17:49.780198 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:17:49.799543 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m07:17:49.801479 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:17:49.802780 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:17:49.809921 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:49.810642 [debug] [MainThread]: On master: BEGIN
[0m07:17:49.811127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:17:49.829225 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m07:17:49.829963 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:49.830532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:17:49.842077 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m07:17:49.843918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2113eff2-287b-4334-98c4-c53c17130b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312533880>]}
[0m07:17:49.844660 [debug] [MainThread]: On master: ROLLBACK
[0m07:17:49.845971 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:49.846416 [debug] [MainThread]: On master: BEGIN
[0m07:17:49.847655 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:17:49.848144 [debug] [MainThread]: On master: COMMIT
[0m07:17:49.848549 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:49.848974 [debug] [MainThread]: On master: COMMIT
[0m07:17:49.849910 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:17:49.850393 [debug] [MainThread]: On master: Close
[0m07:17:49.855574 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:17:49.856441 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:17:49.857161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:17:49.857664 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:17:49.870321 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:17:49.871484 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:17:49.921604 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:17:49.923114 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:17:49.923763 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:17:49.924319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:49.942262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m07:17:49.942976 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:17:49.943564 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:17:49.945456 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:17:49.946137 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:17:49.947288 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:17:49.950923 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:17:49.953475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113eff2-287b-4334-98c4-c53c17130b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8313558550>]}
[0m07:17:49.954517 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.09s]
[0m07:17:49.955355 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:17:49.955929 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:17:49.956708 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:17:49.957622 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_device_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql.
[0m07:17:49.958458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:17:49.960442 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:17:49.964980 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:17:49.965893 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:17:49.973179 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:17:49.974273 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:17:49.974828 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:17:49.975342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:49.989893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:17:49.990612 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:17:49.991193 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:17:49.992732 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:17:49.993304 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:17:49.994432 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:17:49.995914 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:17:49.996726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113eff2-287b-4334-98c4-c53c17130b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83134534f0>]}
[0m07:17:49.997790 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.04s]
[0m07:17:49.998637 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:17:49.999504 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql.
[0m07:17:50.000662 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:17:50.001826 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:17:50.002472 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:17:50.004404 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:50.004864 [debug] [MainThread]: On master: BEGIN
[0m07:17:50.005302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:17:50.019840 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:17:50.020481 [debug] [MainThread]: On master: COMMIT
[0m07:17:50.020919 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:50.021375 [debug] [MainThread]: On master: COMMIT
[0m07:17:50.022437 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:17:50.022907 [debug] [MainThread]: On master: Close
[0m07:17:50.023659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:50.024110 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:17:50.024655 [info ] [MainThread]: 
[0m07:17:50.025173 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m07:17:50.026454 [debug] [MainThread]: Command end result
[0m07:17:50.059295 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:17:50.062030 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:17:50.071682 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:17:50.072251 [info ] [MainThread]: 
[0m07:17:50.072749 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:17:50.073259 [info ] [MainThread]: 
[0m07:17:50.073896 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:17:50.074400 [info ] [MainThread]: 
[0m07:17:50.074889 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:17:50.075349 [info ] [MainThread]: 
[0m07:17:50.075766 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:17:50.077117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6434888, "process_in_blocks": "406", "process_kernel_time": 0.684107, "process_mem_max_rss": "116788", "process_out_blocks": "1872", "process_user_time": 3.864145}
[0m07:17:50.077801 [debug] [MainThread]: Command `dbt run` failed at 07:17:50.077556 after 1.64 seconds
[0m07:17:50.078389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83145e6f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f831259e800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83136e7dc0>]}
[0m07:17:50.079148 [debug] [MainThread]: Flushing usage events
[0m07:17:50.201285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:18:18.079756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f89ba2f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f88a5ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f88a5b9a0>]}


============================== 07:18:18.087674 | 2b678239-ea60-4bf1-9134-e30033d723b5 ==============================
[0m07:18:18.087674 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:18:18.088776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:18:18.491229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b678239-ea60-4bf1-9134-e30033d723b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f8b441db0>]}
[0m07:18:18.662445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b678239-ea60-4bf1-9134-e30033d723b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f8b12fc70>]}
[0m07:18:18.664187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:18:18.900111 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:18:19.266497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:18:19.267630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:18:19.424940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b678239-ea60-4bf1-9134-e30033d723b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f87ee5ae0>]}
[0m07:18:19.719395 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:18:19.725258 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:18:19.752714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b678239-ea60-4bf1-9134-e30033d723b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f87e6efe0>]}
[0m07:18:19.754161 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:18:19.755303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b678239-ea60-4bf1-9134-e30033d723b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f87e6d960>]}
[0m07:18:19.759126 [info ] [MainThread]: 
[0m07:18:19.759828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:18:19.760467 [info ] [MainThread]: 
[0m07:18:19.761482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:18:19.777357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:18:19.874078 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:18:19.875134 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:18:19.875830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:18:19.945376 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m07:18:19.950302 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:18:19.953925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:18:20.073623 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:18:20.075124 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:18:20.076301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:18:20.120135 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m07:18:20.121098 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:18:20.122025 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:18:20.150743 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.028 seconds
[0m07:18:20.154585 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:18:20.176869 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:18:20.191434 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:20.192559 [debug] [MainThread]: On master: BEGIN
[0m07:18:20.193226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:18:20.242158 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m07:18:20.243076 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:20.243996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:18:20.262154 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m07:18:20.265260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b678239-ea60-4bf1-9134-e30033d723b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f89c72830>]}
[0m07:18:20.266652 [debug] [MainThread]: On master: ROLLBACK
[0m07:18:20.271293 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:20.272435 [debug] [MainThread]: On master: BEGIN
[0m07:18:20.279139 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:18:20.279937 [debug] [MainThread]: On master: COMMIT
[0m07:18:20.280647 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:20.281309 [debug] [MainThread]: On master: COMMIT
[0m07:18:20.289219 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m07:18:20.290252 [debug] [MainThread]: On master: Close
[0m07:18:20.306850 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:18:20.308145 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:18:20.309295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:18:20.311394 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:18:20.334847 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:18:20.336442 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:18:20.441640 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:18:20.444291 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:18:20.445232 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:18:20.446119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:20.521528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m07:18:20.523247 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:18:20.527427 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:18:20.530568 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:18:20.531671 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:18:20.542551 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:18:20.547229 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:18:20.557303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b678239-ea60-4bf1-9134-e30033d723b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f884fdd80>]}
[0m07:18:20.561003 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.25s]
[0m07:18:20.567402 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:18:20.568431 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:18:20.569599 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:18:20.575032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:18:20.575826 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:18:20.585872 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_device_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql.
[0m07:18:20.597995 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:18:20.599383 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:18:20.625397 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:18:20.627245 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:18:20.628110 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:18:20.628609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:20.691979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m07:18:20.693225 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:18:20.694425 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:18:20.715393 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:18:20.716615 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:18:20.730868 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:18:20.733639 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:18:20.735065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b678239-ea60-4bf1-9134-e30033d723b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f89c399f0>]}
[0m07:18:20.736545 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.16s]
[0m07:18:20.737863 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:18:20.739263 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql.
[0m07:18:20.744709 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:18:20.745626 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:18:20.746689 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:18:20.751685 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:20.752570 [debug] [MainThread]: On master: BEGIN
[0m07:18:20.753201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:18:20.812909 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m07:18:20.814250 [debug] [MainThread]: On master: COMMIT
[0m07:18:20.815226 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:20.816132 [debug] [MainThread]: On master: COMMIT
[0m07:18:20.818612 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m07:18:20.819454 [debug] [MainThread]: On master: Close
[0m07:18:20.820865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:18:20.823368 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:18:20.824679 [info ] [MainThread]: 
[0m07:18:20.825567 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m07:18:20.828437 [debug] [MainThread]: Command end result
[0m07:18:20.894372 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:18:20.901280 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:18:20.924306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:18:20.925443 [info ] [MainThread]: 
[0m07:18:20.926450 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:18:20.927200 [info ] [MainThread]: 
[0m07:18:20.928028 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:18:20.928688 [info ] [MainThread]: 
[0m07:18:20.929495 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:18:20.930280 [info ] [MainThread]: 
[0m07:18:20.930939 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:18:20.933008 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0093746, "process_in_blocks": "458", "process_kernel_time": 0.445674, "process_mem_max_rss": "116984", "process_out_blocks": "1872", "process_user_time": 5.946549}
[0m07:18:20.933988 [debug] [MainThread]: Command `dbt run` failed at 07:18:20.933653 after 3.01 seconds
[0m07:18:20.934828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f89ba2f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f87e6efe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f8ac3a470>]}
[0m07:18:20.935850 [debug] [MainThread]: Flushing usage events
[0m07:18:21.067032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:19:09.649195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823b365510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8238f7dd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8238f7dd20>]}


============================== 07:19:09.653519 | 108b3939-1658-43bb-8938-2a597eb49b5e ==============================
[0m07:19:09.653519 [info ] [MainThread]: Running with dbt=1.7.19
[0m07:19:09.654385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:19:09.883233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8238f7de70>]}
[0m07:19:09.981557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8238a1cdf0>]}
[0m07:19:09.982812 [info ] [MainThread]: Registered adapter: postgres=1.7.19
[0m07:19:09.995442 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m07:19:10.010124 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m07:19:10.010817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82390fc400>]}
[0m07:19:12.062423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8237d963b0>]}
[0m07:19:12.100212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8237ec03d0>]}
[0m07:19:12.101520 [info ] [MainThread]: Found 3 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 415 macros, 0 groups, 0 semantic models
[0m07:19:12.102571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8237ec0310>]}
[0m07:19:12.107228 [info ] [MainThread]: 
[0m07:19:12.109181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:19:12.112383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:19:12.142428 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:19:12.143629 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:19:12.144591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:12.197304 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:19:12.201363 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:19:12.210422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:19:12.227457 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:19:12.228535 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:19:12.229603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:19:12.252621 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:19:12.254211 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:19:12.255232 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:19:12.271162 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:19:12.274850 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:19:12.276677 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:19:12.289604 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:12.290656 [debug] [MainThread]: On master: BEGIN
[0m07:19:12.291547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:19:12.313274 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:19:12.314545 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:12.315623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:19:12.331653 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:19:12.335047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8237d8c8b0>]}
[0m07:19:12.336429 [debug] [MainThread]: On master: ROLLBACK
[0m07:19:12.338623 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:12.339608 [debug] [MainThread]: On master: BEGIN
[0m07:19:12.342690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:19:12.343703 [debug] [MainThread]: On master: COMMIT
[0m07:19:12.344719 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:12.345580 [debug] [MainThread]: On master: COMMIT
[0m07:19:12.347445 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:19:12.348331 [debug] [MainThread]: On master: Close
[0m07:19:12.351292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:19:12.352771 [info ] [MainThread]: 
[0m07:19:12.361324 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:19:12.363068 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:19:12.364930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:19:12.366044 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:19:12.388707 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:19:12.390926 [debug] [Thread-1 (]: Timing info for model.patient_etl_analytics.stg_device_readings (compile): 07:19:12.366666 => 07:19:12.390157
[0m07:19:12.392204 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:19:12.488275 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:19:12.490039 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:19:12.491045 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:19:12.491895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:19:12.514874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:19:12.516103 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:19:12.517092 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:19:12.519872 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:19:12.520767 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:19:12.523205 [debug] [Thread-1 (]: Timing info for model.patient_etl_analytics.stg_device_readings (execute): 07:19:12.392925 => 07:19:12.522547
[0m07:19:12.524213 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:19:12.529444 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled Code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:19:12.530822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8237da78e0>]}
[0m07:19:12.532319 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.17s]
[0m07:19:12.533836 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:19:12.535124 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:19:12.536522 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:19:12.540140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:19:12.541079 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:19:12.549047 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:19:12.551139 [debug] [Thread-1 (]: Timing info for model.patient_etl_analytics.stg_patients (compile): 07:19:12.541591 => 07:19:12.550288
[0m07:19:12.552082 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:19:12.563344 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:19:12.565259 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:19:12.566364 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:19:12.567279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:19:12.587592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:19:12.588812 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:19:12.590018 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:19:12.592488 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:19:12.593493 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:19:12.595798 [debug] [Thread-1 (]: Timing info for model.patient_etl_analytics.stg_patients (execute): 07:19:12.552680 => 07:19:12.595178
[0m07:19:12.596842 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:19:12.600066 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled Code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:19:12.601232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '108b3939-1658-43bb-8938-2a597eb49b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8237d9f010>]}
[0m07:19:12.602808 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.06s]
[0m07:19:12.604595 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:19:12.606932 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:19:12.609174 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:19:12.610473 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:19:12.614506 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:12.615341 [debug] [MainThread]: On master: BEGIN
[0m07:19:12.616095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:19:12.638204 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:19:12.639410 [debug] [MainThread]: On master: COMMIT
[0m07:19:12.640283 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:12.641009 [debug] [MainThread]: On master: COMMIT
[0m07:19:12.643266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:19:12.644152 [debug] [MainThread]: On master: Close
[0m07:19:12.645787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:19:12.646515 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:19:12.647393 [info ] [MainThread]: 
[0m07:19:12.648224 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m07:19:12.650507 [debug] [MainThread]: Command end result
[0m07:19:12.672518 [info ] [MainThread]: 
[0m07:19:12.673605 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:19:12.674534 [info ] [MainThread]: 
[0m07:19:12.675727 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled Code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:19:12.676639 [info ] [MainThread]: 
[0m07:19:12.677437 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled Code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:19:12.678346 [info ] [MainThread]: 
[0m07:19:12.679172 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:19:12.681110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1044712, "process_user_time": 5.975434, "process_kernel_time": 0.308978, "process_mem_max_rss": "122064", "process_in_blocks": "596", "process_out_blocks": "2584", "command_success": false}
[0m07:19:12.682233 [debug] [MainThread]: Command `dbt run` failed at 07:19:12.681880 after 3.11 seconds
[0m07:19:12.683153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823b365510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8238f7de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8237ec0940>]}
[0m07:19:12.684164 [debug] [MainThread]: Flushing usage events
[0m07:22:14.127031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6ab0af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b699a7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b699a7700>]}


============================== 07:22:14.131165 | 370b9916-0e5a-48ed-85ae-8133d10ebde7 ==============================
[0m07:22:14.131165 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:22:14.132067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:22:14.379894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6c463340>]}
[0m07:22:14.474145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6a7c2da0>]}
[0m07:22:14.475397 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:22:14.593252 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:22:14.772139 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m07:22:14.772854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6a0daa40>]}
[0m07:22:16.648865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b687a61a0>]}
[0m07:22:16.799342 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:22:16.803590 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:22:16.821206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b687900a0>]}
[0m07:22:16.822151 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:22:16.822666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b687901c0>]}
[0m07:22:16.825282 [info ] [MainThread]: 
[0m07:22:16.825950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:22:16.826375 [info ] [MainThread]: 
[0m07:22:16.827151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:22:16.834269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:22:16.885142 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:22:16.885885 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:22:16.886363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:16.904429 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m07:22:16.906575 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:22:16.909100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:22:16.918928 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:22:16.919473 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:22:16.920001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:22:16.935657 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m07:22:16.936396 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:22:16.936934 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:22:16.947277 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m07:22:16.949204 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:22:16.950334 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:22:16.957406 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:16.958123 [debug] [MainThread]: On master: BEGIN
[0m07:22:16.958526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:22:16.972384 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:22:16.973142 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:16.973731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:22:16.982845 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m07:22:16.984739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b68e92380>]}
[0m07:22:16.985499 [debug] [MainThread]: On master: ROLLBACK
[0m07:22:16.986610 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:16.987089 [debug] [MainThread]: On master: BEGIN
[0m07:22:16.988195 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:22:16.988635 [debug] [MainThread]: On master: COMMIT
[0m07:22:16.989100 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:16.989486 [debug] [MainThread]: On master: COMMIT
[0m07:22:16.990638 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:22:16.991201 [debug] [MainThread]: On master: Close
[0m07:22:16.996557 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:22:16.997471 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:22:16.998295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:22:16.998864 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:22:17.011280 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:22:17.012557 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:22:17.063097 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:22:17.064481 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:22:17.065104 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:22:17.065578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:17.081547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m07:22:17.082452 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:22:17.083082 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:22:17.084836 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:22:17.085406 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:22:17.086975 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:22:17.090101 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:22:17.093021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b67c70bb0>]}
[0m07:22:17.094200 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.09s]
[0m07:22:17.095185 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:22:17.095843 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:22:17.096689 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_device_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql.
[0m07:22:17.097766 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:22:17.099873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:22:17.100405 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:22:17.106991 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:22:17.107905 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:22:17.204181 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:22:17.205317 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:22:17.205978 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:22:17.206454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:17.222332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m07:22:17.223145 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:22:17.223745 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:22:17.225565 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:22:17.226285 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:22:17.227705 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:22:17.229398 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:22:17.230356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370b9916-0e5a-48ed-85ae-8133d10ebde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6abbe980>]}
[0m07:22:17.231392 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.13s]
[0m07:22:17.232253 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:22:17.233191 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql.
[0m07:22:17.234893 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:22:17.235475 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:22:17.236118 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:22:17.238436 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:17.238980 [debug] [MainThread]: On master: BEGIN
[0m07:22:17.239383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:22:17.253651 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:22:17.254379 [debug] [MainThread]: On master: COMMIT
[0m07:22:17.254889 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:17.255299 [debug] [MainThread]: On master: COMMIT
[0m07:22:17.256284 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:22:17.256763 [debug] [MainThread]: On master: Close
[0m07:22:17.257588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:17.258106 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:22:17.258611 [info ] [MainThread]: 
[0m07:22:17.259152 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m07:22:17.260321 [debug] [MainThread]: Command end result
[0m07:22:17.294691 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:22:17.297359 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:22:17.307151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:22:17.307693 [info ] [MainThread]: 
[0m07:22:17.308348 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:22:17.308843 [info ] [MainThread]: 
[0m07:22:17.309392 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:22:17.310014 [info ] [MainThread]: 
[0m07:22:17.310504 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:22:17.310967 [info ] [MainThread]: 
[0m07:22:17.311385 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:22:17.312569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2760901, "process_in_blocks": "242", "process_kernel_time": 0.191881, "process_mem_max_rss": "123420", "process_out_blocks": "2728", "process_user_time": 5.160779}
[0m07:22:17.313239 [debug] [MainThread]: Command `dbt run` failed at 07:22:17.313092 after 3.28 seconds
[0m07:22:17.313835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6ab0af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6a7c2da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b68883b80>]}
[0m07:22:17.314385 [debug] [MainThread]: Flushing usage events
[0m07:22:17.433378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:23:20.549869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069f29ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069e1648e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069e164940>]}


============================== 07:23:20.554231 | 64d05b4c-5b42-4ab0-b01b-cc3092066412 ==============================
[0m07:23:20.554231 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:23:20.555145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:23:20.808765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64d05b4c-5b42-4ab0-b01b-cc3092066412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06a0bf8490>]}
[0m07:23:20.899804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64d05b4c-5b42-4ab0-b01b-cc3092066412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069dbdb9d0>]}
[0m07:23:20.901033 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:23:21.017651 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:23:21.223111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:23:21.223821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:23:21.304677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64d05b4c-5b42-4ab0-b01b-cc3092066412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069d5cd900>]}
[0m07:23:21.461574 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:23:21.465527 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:23:21.483379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64d05b4c-5b42-4ab0-b01b-cc3092066412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069d5cece0>]}
[0m07:23:21.484256 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:23:21.484805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64d05b4c-5b42-4ab0-b01b-cc3092066412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069d5ced10>]}
[0m07:23:21.487476 [info ] [MainThread]: 
[0m07:23:21.488062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:23:21.488462 [info ] [MainThread]: 
[0m07:23:21.489207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:23:21.496374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:23:21.551144 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:23:21.551843 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:23:21.552302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:21.571131 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m07:23:21.573199 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:23:21.575675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:23:21.585655 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:23:21.586382 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:23:21.586843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:23:21.601396 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m07:23:21.602206 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:23:21.602668 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:23:21.613169 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m07:23:21.615291 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:23:21.616620 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:23:21.624229 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:21.624864 [debug] [MainThread]: On master: BEGIN
[0m07:23:21.625281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:23:21.641194 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m07:23:21.642035 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:21.642622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:23:21.651960 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m07:23:21.654344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64d05b4c-5b42-4ab0-b01b-cc3092066412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06a06dbe20>]}
[0m07:23:21.655320 [debug] [MainThread]: On master: ROLLBACK
[0m07:23:21.657163 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:21.657858 [debug] [MainThread]: On master: BEGIN
[0m07:23:21.659681 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:23:21.660219 [debug] [MainThread]: On master: COMMIT
[0m07:23:21.660651 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:21.661101 [debug] [MainThread]: On master: COMMIT
[0m07:23:21.662305 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:23:21.662899 [debug] [MainThread]: On master: Close
[0m07:23:21.668461 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:23:21.669382 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:23:21.670224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:23:21.670782 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:23:21.683643 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:23:21.684651 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:23:21.811044 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:23:21.812245 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:23:21.812947 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:23:21.813434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:21.829905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m07:23:21.830645 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:23:21.831287 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:23:21.833074 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:23:21.833636 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:23:21.835248 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:23:21.838345 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:23:21.840990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d05b4c-5b42-4ab0-b01b-cc3092066412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069e3a21d0>]}
[0m07:23:21.842102 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.17s]
[0m07:23:21.842977 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:23:21.843593 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:23:21.844334 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:23:21.845278 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_device_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql.
[0m07:23:21.846175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:23:21.847904 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:23:21.852575 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:23:21.853626 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:23:21.859366 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:23:21.860479 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:23:21.861042 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:23:21.861478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:21.875793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:23:21.876479 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:23:21.877070 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:23:21.878554 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:23:21.879179 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:23:21.880316 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:23:21.881957 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:23:21.882775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d05b4c-5b42-4ab0-b01b-cc3092066412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069f352a10>]}
[0m07:23:21.883760 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.04s]
[0m07:23:21.884551 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:23:21.885545 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql.
[0m07:23:21.887005 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:23:21.887638 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:23:21.888360 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:23:21.891076 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:21.891594 [debug] [MainThread]: On master: BEGIN
[0m07:23:21.892091 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:23:21.907301 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:23:21.908049 [debug] [MainThread]: On master: COMMIT
[0m07:23:21.908509 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:21.909061 [debug] [MainThread]: On master: COMMIT
[0m07:23:21.909980 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:23:21.910488 [debug] [MainThread]: On master: Close
[0m07:23:21.911291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:21.911745 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:23:21.912282 [info ] [MainThread]: 
[0m07:23:21.912793 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m07:23:21.914137 [debug] [MainThread]: Command end result
[0m07:23:21.950407 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:23:21.953167 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:23:21.963353 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:23:21.964145 [info ] [MainThread]: 
[0m07:23:21.964764 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:23:21.965236 [info ] [MainThread]: 
[0m07:23:21.965907 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:23:21.966374 [info ] [MainThread]: 
[0m07:23:21.966955 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:23:21.967387 [info ] [MainThread]: 
[0m07:23:21.967911 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:23:21.969301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.507135, "process_in_blocks": "242", "process_kernel_time": 0.231651, "process_mem_max_rss": "116512", "process_out_blocks": "1872", "process_user_time": 3.474282}
[0m07:23:21.970159 [debug] [MainThread]: Command `dbt run` failed at 07:23:21.969993 after 1.51 seconds
[0m07:23:21.970751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069f29ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069d582770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f069ef20880>]}
[0m07:23:21.971298 [debug] [MainThread]: Flushing usage events
[0m07:23:22.116059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:24:34.664328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26108eef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25ff976d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25ff97670>]}


============================== 07:24:34.669206 | 2a33dcba-7999-4c6a-ae52-fb251d81e36e ==============================
[0m07:24:34.669206 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:24:34.670606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:24:35.103325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a33dcba-7999-4c6a-ae52-fb251d81e36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25f9f3dc0>]}
[0m07:24:35.256384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a33dcba-7999-4c6a-ae52-fb251d81e36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff260f0f100>]}
[0m07:24:35.258198 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:24:35.542170 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:24:35.924328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:24:35.925255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:24:36.077158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a33dcba-7999-4c6a-ae52-fb251d81e36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25f3ed8a0>]}
[0m07:24:36.387208 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:24:36.401645 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:24:36.441048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a33dcba-7999-4c6a-ae52-fb251d81e36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25f3ee6e0>]}
[0m07:24:36.443606 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:24:36.444775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a33dcba-7999-4c6a-ae52-fb251d81e36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25f3ec0d0>]}
[0m07:24:36.450002 [info ] [MainThread]: 
[0m07:24:36.450924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:24:36.451531 [info ] [MainThread]: 
[0m07:24:36.453157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:24:36.472654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:24:36.662834 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:24:36.663918 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:24:36.664671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:36.785973 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.121 seconds
[0m07:24:36.790199 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:24:36.794183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:24:36.812472 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:24:36.813370 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:24:36.814202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:24:36.881248 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m07:24:36.882641 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:24:36.883714 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:24:36.916443 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m07:24:36.921105 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:24:36.922812 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:24:36.939861 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:36.941118 [debug] [MainThread]: On master: BEGIN
[0m07:24:36.942003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:24:36.971092 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m07:24:36.971831 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:36.972391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:24:36.982724 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m07:24:36.984723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a33dcba-7999-4c6a-ae52-fb251d81e36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff261b6a020>]}
[0m07:24:36.985494 [debug] [MainThread]: On master: ROLLBACK
[0m07:24:36.987020 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:36.987500 [debug] [MainThread]: On master: BEGIN
[0m07:24:36.989237 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:24:36.989825 [debug] [MainThread]: On master: COMMIT
[0m07:24:36.990261 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:36.990726 [debug] [MainThread]: On master: COMMIT
[0m07:24:36.991663 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:24:36.992108 [debug] [MainThread]: On master: Close
[0m07:24:36.998106 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:24:36.999068 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:24:36.999824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:24:37.000338 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:24:37.014003 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:24:37.015084 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:24:37.151350 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:24:37.152745 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:24:37.153349 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:24:37.153933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:37.170714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m07:24:37.171447 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:24:37.172175 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:24:37.174738 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:24:37.175336 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:24:37.176847 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:24:37.180176 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:24:37.182927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a33dcba-7999-4c6a-ae52-fb251d81e36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25f8ec520>]}
[0m07:24:37.183986 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.18s]
[0m07:24:37.184879 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:24:37.185493 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:24:37.186336 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:24:37.187476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:24:37.188166 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:24:37.193135 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:24:37.194215 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_device_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql.
[0m07:24:37.196537 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:24:37.203076 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:24:37.204164 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:24:37.204830 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:24:37.205309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:37.231993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m07:24:37.232841 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:24:37.233462 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:24:37.235203 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:24:37.235839 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:24:37.237286 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:24:37.239049 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:24:37.239885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a33dcba-7999-4c6a-ae52-fb251d81e36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2611465c0>]}
[0m07:24:37.240909 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.05s]
[0m07:24:37.241967 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:24:37.243005 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql.
[0m07:24:37.244839 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:24:37.245893 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:24:37.246968 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:24:37.249380 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:37.249988 [debug] [MainThread]: On master: BEGIN
[0m07:24:37.250414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:24:37.266000 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:24:37.266714 [debug] [MainThread]: On master: COMMIT
[0m07:24:37.267199 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:37.267650 [debug] [MainThread]: On master: COMMIT
[0m07:24:37.268805 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:24:37.269287 [debug] [MainThread]: On master: Close
[0m07:24:37.270268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:37.270945 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:24:37.271501 [info ] [MainThread]: 
[0m07:24:37.272031 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m07:24:37.273228 [debug] [MainThread]: Command end result
[0m07:24:37.309042 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:24:37.311835 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:24:37.323852 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:24:37.324439 [info ] [MainThread]: 
[0m07:24:37.325038 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:24:37.325471 [info ] [MainThread]: 
[0m07:24:37.326184 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:24:37.326691 [info ] [MainThread]: 
[0m07:24:37.327195 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:24:37.327680 [info ] [MainThread]: 
[0m07:24:37.328117 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:24:37.329397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8187253, "process_in_blocks": "242", "process_kernel_time": 0.578392, "process_mem_max_rss": "116632", "process_out_blocks": "1872", "process_user_time": 5.572453}
[0m07:24:37.330184 [debug] [MainThread]: Command `dbt run` failed at 07:24:37.330034 after 2.82 seconds
[0m07:24:37.330776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26108eef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25f3a6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff25ef3c280>]}
[0m07:24:37.331320 [debug] [MainThread]: Flushing usage events
[0m07:24:37.466519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:25:47.720118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb04626ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0356c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0356c9a0>]}


============================== 07:25:47.726173 | 09c01be5-c908-4c40-a322-21f3bfe1bb53 ==============================
[0m07:25:47.726173 [info ] [MainThread]: Running with dbt=1.9.4
[0m07:25:47.727260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m07:25:48.037866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09c01be5-c908-4c40-a322-21f3bfe1bb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb02f87dc0>]}
[0m07:25:48.141724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09c01be5-c908-4c40-a322-21f3bfe1bb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb044a3100>]}
[0m07:25:48.143050 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:25:48.278730 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m07:25:48.530505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:25:48.531148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:25:48.620822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09c01be5-c908-4c40-a322-21f3bfe1bb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb025d58a0>]}
[0m07:25:48.799135 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:25:48.803645 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:25:48.822711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09c01be5-c908-4c40-a322-21f3bfe1bb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb025d66e0>]}
[0m07:25:48.823734 [info ] [MainThread]: Found 3 models, 6 data tests, 2 sources, 433 macros
[0m07:25:48.824280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09c01be5-c908-4c40-a322-21f3bfe1bb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb025d40d0>]}
[0m07:25:48.827753 [info ] [MainThread]: 
[0m07:25:48.828371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:25:48.828859 [info ] [MainThread]: 
[0m07:25:48.829778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:25:48.837261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_etl_data'
[0m07:25:48.900253 [debug] [ThreadPool]: Using postgres connection "list_etl_data"
[0m07:25:48.901041 [debug] [ThreadPool]: On list_etl_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data"} */

    select distinct nspname from pg_namespace
  
[0m07:25:48.901789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:48.933789 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m07:25:48.936437 [debug] [ThreadPool]: On list_etl_data: Close
[0m07:25:48.939226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_etl_data, now list_etl_data_public)
[0m07:25:48.949531 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:25:48.950216 [debug] [ThreadPool]: On list_etl_data_public: BEGIN
[0m07:25:48.950697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:48.965793 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m07:25:48.966500 [debug] [ThreadPool]: Using postgres connection "list_etl_data_public"
[0m07:25:48.967000 [debug] [ThreadPool]: On list_etl_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "list_etl_data_public"} */
select
      'etl_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'etl_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:25:48.980950 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m07:25:48.983111 [debug] [ThreadPool]: On list_etl_data_public: ROLLBACK
[0m07:25:48.984716 [debug] [ThreadPool]: On list_etl_data_public: Close
[0m07:25:48.992121 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:48.992771 [debug] [MainThread]: On master: BEGIN
[0m07:25:48.993188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:25:49.009211 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m07:25:49.010577 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:49.011416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:25:49.021654 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m07:25:49.023639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09c01be5-c908-4c40-a322-21f3bfe1bb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb050fa020>]}
[0m07:25:49.024351 [debug] [MainThread]: On master: ROLLBACK
[0m07:25:49.025831 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:49.026536 [debug] [MainThread]: On master: BEGIN
[0m07:25:49.028656 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m07:25:49.029580 [debug] [MainThread]: On master: COMMIT
[0m07:25:49.031292 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:49.031950 [debug] [MainThread]: On master: COMMIT
[0m07:25:49.033608 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:25:49.034210 [debug] [MainThread]: On master: Close
[0m07:25:49.039969 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_device_readings
[0m07:25:49.040956 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_device_readings ......................... [RUN]
[0m07:25:49.041849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_etl_data_public, now model.patient_etl_analytics.stg_device_readings)
[0m07:25:49.042381 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_device_readings
[0m07:25:49.055419 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_device_readings"
[0m07:25:49.056614 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_device_readings
[0m07:25:49.190268 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_device_readings"
[0m07:25:49.191526 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:25:49.192085 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: BEGIN
[0m07:25:49.192603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:49.208731 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m07:25:49.209537 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_device_readings"
[0m07:25:49.210304 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_device_readings"} */

  create view "etl_data"."public"."stg_device_readings__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_device_readings.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."device_readings"
)

SELECT
    id AS device_reading_id, -- Renaming for clarity
    patient_id, -- This should match the patient_id from stg_patients (e.g., patients.id)
    timestamp AS reading_timestamp,
    glucose,
    systolic_bp,
    diastolic_bp,
    weight
FROM
    source
WHERE
    patient_id IS NOT NULL -- Basic data quality filter, if patient_id is crucial for joining
    AND timestamp IS NOT NULL -- Basic data quality filter
    -- Add other filters if necessary, e.g., ensuring numeric fields are valid if not handled by source tests
  );
[0m07:25:49.212185 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.device_readings" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                           ^

[0m07:25:49.212962 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: ROLLBACK
[0m07:25:49.214581 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_device_readings: Close
[0m07:25:49.217894 [debug] [Thread-1 (]: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:25:49.220899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09c01be5-c908-4c40-a322-21f3bfe1bb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb02b431c0>]}
[0m07:25:49.222045 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_device_readings ................ [[31mERROR[0m in 0.18s]
[0m07:25:49.222970 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_device_readings
[0m07:25:49.223615 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.stg_patients
[0m07:25:49.224337 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_patients ................................ [RUN]
[0m07:25:49.225181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.patient_etl_analytics.stg_device_readings, now model.patient_etl_analytics.stg_patients)
[0m07:25:49.225879 [debug] [Thread-1 (]: Began compiling node model.patient_etl_analytics.stg_patients
[0m07:25:49.231302 [debug] [Thread-1 (]: Writing injected SQL for node "model.patient_etl_analytics.stg_patients"
[0m07:25:49.232893 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_device_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql.
[0m07:25:49.236020 [debug] [Thread-1 (]: Began executing node model.patient_etl_analytics.stg_patients
[0m07:25:49.242587 [debug] [Thread-1 (]: Writing runtime sql for node "model.patient_etl_analytics.stg_patients"
[0m07:25:49.243717 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:25:49.244255 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: BEGIN
[0m07:25:49.244787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:49.259567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:25:49.260286 [debug] [Thread-1 (]: Using postgres connection "model.patient_etl_analytics.stg_patients"
[0m07:25:49.260910 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "patient_etl_profile", "target_name": "dev", "node_id": "model.patient_etl_analytics.stg_patients"} */

  create view "etl_data"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- dbt_project/models/staging/stg_patients.sql

WITH source AS (
    SELECT * FROM "etl_data"."public"."patients"
)

SELECT
    id AS patient_id, -- Renaming for clarity in downstream models if desired, or keep as 'id'
    name AS patient_name,
    dob AS date_of_birth,
    gender,
    sex
    -- email, phone, address can be added if needed for analytics
    -- For biometric analytics, these might not be immediately necessary
FROM
    source
  );
[0m07:25:49.262662 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.patients" does not exist
LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                           ^

[0m07:25:49.263239 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: ROLLBACK
[0m07:25:49.264600 [debug] [Thread-1 (]: On model.patient_etl_analytics.stg_patients: Close
[0m07:25:49.266284 [debug] [Thread-1 (]: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:25:49.267116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09c01be5-c908-4c40-a322-21f3bfe1bb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb03541e40>]}
[0m07:25:49.268142 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.stg_patients ....................... [[31mERROR[0m in 0.04s]
[0m07:25:49.269192 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.stg_patients
[0m07:25:49.270670 [debug] [Thread-4 (]: Marking all children of 'model.patient_etl_analytics.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql.
[0m07:25:49.272184 [debug] [Thread-1 (]: Began running node model.patient_etl_analytics.patient_biometric_summary
[0m07:25:49.272863 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.patient_biometric_summary .......................... [[33mSKIP[0m]
[0m07:25:49.273601 [debug] [Thread-1 (]: Finished running node model.patient_etl_analytics.patient_biometric_summary
[0m07:25:49.276553 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:49.277051 [debug] [MainThread]: On master: BEGIN
[0m07:25:49.277515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:25:49.292336 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:25:49.293014 [debug] [MainThread]: On master: COMMIT
[0m07:25:49.293591 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:49.294117 [debug] [MainThread]: On master: COMMIT
[0m07:25:49.295475 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:25:49.295969 [debug] [MainThread]: On master: Close
[0m07:25:49.296889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:49.297548 [debug] [MainThread]: Connection 'model.patient_etl_analytics.stg_patients' was properly closed.
[0m07:25:49.298335 [info ] [MainThread]: 
[0m07:25:49.298864 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m07:25:49.300074 [debug] [MainThread]: Command end result
[0m07:25:49.337970 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m07:25:49.340633 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m07:25:49.351190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m07:25:49.351813 [info ] [MainThread]: 
[0m07:25:49.352474 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:25:49.352944 [info ] [MainThread]: 
[0m07:25:49.353511 [error] [MainThread]:   Database Error in model stg_device_readings (models/staging/stg_device_readings.sql)
  relation "public.device_readings" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."device_readings"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_device_readings.sql
[0m07:25:49.354069 [info ] [MainThread]: 
[0m07:25:49.354657 [error] [MainThread]:   Database Error in model stg_patients (models/staging/stg_patients.sql)
  relation "public.patients" does not exist
  LINE 10:     SELECT * FROM "etl_data"."public"."patients"
                             ^
  compiled code at target/run/patient_etl_analytics/models/staging/stg_patients.sql
[0m07:25:49.355092 [info ] [MainThread]: 
[0m07:25:49.355626 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m07:25:49.356885 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7466083, "process_in_blocks": "242", "process_kernel_time": 0.378938, "process_mem_max_rss": "116492", "process_out_blocks": "1872", "process_user_time": 3.534159}
[0m07:25:49.357574 [debug] [MainThread]: Command `dbt run` failed at 07:25:49.357374 after 1.75 seconds
[0m07:25:49.358178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb04626ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0258e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb03c22830>]}
[0m07:25:49.358766 [debug] [MainThread]: Flushing usage events
[0m07:25:49.505346 [debug] [MainThread]: An error was encountered while trying to flush usage events
